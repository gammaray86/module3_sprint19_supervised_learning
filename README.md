# Обучение с учителем: качество модели

## Данные

В проекте использованы четыре таблицы с данными интернет-магазина «В один клик»:

- таблица с поведением покупателя на сайте, коммуникациями и продуктовыми характеристиками;  
- таблица с данными о выручке за разные периоды;  
- таблица с временем, проведённым на сайте за каждый период;  
- таблица с прибылью магазина от каждого клиента за последние три месяца.

## Задача

Разработать модель, которая предсказывает, снизилась ли покупательская активность клиента.  
На основе предсказаний и данных о прибыльности сегментировать клиентов и предложить меры для удержания активности.

## Этапы исследования

1. **Загрузка данных** — проверка корректности файлов, типов данных и структуры таблиц, переименованы названия столбцов.  
2. **Предобработка** — нормализация текстов, устранение ошибок, проверка уникальности `id`.  
3. **Исследовательский анализ** — проверка распределений, поиск выбросов и зависимостей, исключение неактивных клиентов.  
4. **Объединение таблиц** — формирование единой таблицы для моделирования на основе данных о поведении, выручке и времени.  
5. **Корреляционный анализ** — выявление мультиколлинеарности и анализ связей между признаками.  
6. **Моделирование** — обучение моделей KNeighborsClassifier, DecisionTreeClassifier, LogisticRegression и SVC в пайплайнах с разными кодировками и масштабированием.  
7. **Подбор гиперпараметров** — кросс-валидация и выбор лучшей модели по метрике ROC-AUC.  
8. **Интерпретация** — анализ важности признаков с помощью SHAP.  
9. **Сегментация** — выделение групп клиентов по вероятности снижения активности и прибыльности, разработка предложений для удержания.

## Результаты

- Лучшая модель — **KNeighborsClassifier** (`n_neighbors=15`, `weights='distance'`, `p=1`).  
- Метрики на тестовой выборке:  
  - ROC-AUC: 0.9253  
  - Accuracy: 0.9138  
  - Precision (1): 0.9444  
  - Recall (1): 0.8226  

Анализ SHAP показал, что на снижение активности сильнее всего влияют:
`pages_per_visit`, `minutes_текущий_месяц`, `minutes_предыдущий_месяц` и `avg_categories_per_visit`.

## Выводы и предложения

Выделены три ключевых сегмента покупателей:
1. **Высокая прибыльность и высокий риск снижения активности** — приоритет удержания, программы лояльности.  
2. **Покупатели с большой долей акционных покупок** — персональные скидки и купоны.  
3. **Клиенты с низким вовлечением на сайте** — персональные подборки, уведомления и геймификация.

## Используемые библиотеки

*pandas, numpy, matplotlib, seaborn, plotly, phik, shap, scikit-learn*